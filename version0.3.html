<!DOCTYPE HTML>                                                                                                      
<html>
    <body>
    <style>
    </style>
       <script src="three.min.js"></script>
        <script>

            //cube
            ////////////////////////////////////////////////
            //cube renderer
            
            var renderer = new THREE.WebGLRenderer();
            renderer.setSize(window.innerWidth, window.innerHeight);
            document.body.appendChild(renderer.domElement);

            var camera = new THREE.PerspectiveCamera(45, window.innerWidth / window.innerHeight, 1, 1000);
            camera.position.y = 0;
            camera.position.z = 400;
            camera.rotation.x = 0;

            var scene = new THREE.Scene();

            var cube = new THREE.Mesh(new THREE.CubeGeometry(20,10,10), new THREE.MeshNormalMaterial());
            cube.rotation.z = 0;
            cube.position.x = 280;
            cube.position.y = 150;

            //add cube to scene
            scene.add(cube);
            
            ////////////////////////////////////////////////

            //sphere
            ////////////////////////////////////////////////

            var sphere = new THREE.Mesh(new THREE.SphereGeometry(10, 20, 20), new THREE.MeshNormalMaterial());
            //sphere.overdraw = true;
            sphere.position.x = 280;
            sphere.position.y = 120;
            scene.add(sphere);


            var cylinder = new THREE.Mesh(new THREE.CylinderGeometry(0, 10, 20, 20, 20, false), new THREE.MeshNormalMaterial());
            cylinder.overdraw = true;
            cylinder.rotation.z = 0;
            cylinder.position.x = 280;
            cylinder.position.y = 90;
            //cylinder.domElement.addEventListener( 'mousedown', onDocumentMouseDown, false );
            scene.add(cylinder);

            //renderer.domElement.addEventListener( 'mousedown', onDocumentMouseDown, false );

/////////////////////////////////////////////////////////////////////////////////////////////////
				renderer.domElement.addEventListener( 'mousemove', onDocumentMouseMove, false );
				renderer.domElement.addEventListener( 'mousedown', onDocumentMouseDown, false );
				renderer.domElement.addEventListener( 'mouseup', onDocumentMouseUp, false );
			function onDocumentMouseMove( event ) {

				event.preventDefault();

				mouse.x = ( event.clientX / window.innerWidth ) * 2 - 1;
				mouse.y = - ( event.clientY / window.innerHeight ) * 2 + 1;

				//

				var vector = new THREE.Vector3( mouse.x, mouse.y, 0.5 );
				projector.unprojectVector( vector, camera );

				var raycaster = new THREE.Raycaster( camera.position, vector.sub( camera.position ).normalize() );


				if ( SELECTED ) {

					var intersects = raycaster.intersectObject( plane );
					SELECTED.position.copy( intersects[ 0 ].point.sub( offset ) );
					return;

				}


				var intersects = raycaster.intersectObjects( objects );

				if ( intersects.length > 0 ) {

					if ( INTERSECTED != intersects[ 0 ].object ) {

						if ( INTERSECTED ) INTERSECTED.material.color.setHex( INTERSECTED.currentHex );

						INTERSECTED = intersects[ 0 ].object;
						INTERSECTED.currentHex = INTERSECTED.material.color.getHex();

						plane.position.copy( INTERSECTED.position );
						plane.lookAt( camera.position );

					}

					container.style.cursor = 'pointer';

				} else {

					if ( INTERSECTED ) INTERSECTED.material.color.setHex( INTERSECTED.currentHex );

					INTERSECTED = null;

					container.style.cursor = 'auto';

				}

			}

			function onDocumentMouseDown( event ) {

				event.preventDefault();

				var vector = new THREE.Vector3( mouse.x, mouse.y, 0.5 );
				projector.unprojectVector( vector, camera );

				var raycaster = new THREE.Raycaster( camera.position, vector.sub( camera.position ).normalize() );

				var intersects = raycaster.intersectObjects( objects );

				if ( intersects.length > 0 ) {

					controls.enabled = false;

					SELECTED = intersects[ 0 ].object;

					var intersects = raycaster.intersectObject( plane );
					offset.copy( intersects[ 0 ].point ).sub( plane.position );

					container.style.cursor = 'move';

				}

			}

			function onDocumentMouseUp( event ) {

				event.preventDefault();

				controls.enabled = true;

				if ( INTERSECTED ) {

					plane.position.copy( INTERSECTED.position );

					SELECTED = null;

				}

				container.style.cursor = 'auto';

			}
			function animate() {

				requestAnimationFrame( animate );

				render();
				stats.update();

			}

			function render() {

				controls.update();

				renderer.render( scene, camera );

			}
/////////////////////////////////////////////////////////////////////////////////////////////////
            renderer.render(scene, camera);
            //animate();
/*
            function onDocumentMouseDown( event ) {
                alert( "down" );
            }
*/
        </script>
    </body>
</html>
